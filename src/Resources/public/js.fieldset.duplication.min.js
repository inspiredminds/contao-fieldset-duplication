!function(){"use strict";window.fieldsetDuplication=function(t,e){var n=Object.assign({},{prepend:!1,buttonAdd:"+",buttonRemove:"Ã—",widgetSelector:".widget"},e,JSON.parse(t.dataset.fieldsetDuplicationConfig||"{}")),i=null,o=null,l=null,c=0,a=t.className.split(/\s+/);a.some((function(t){if(t.match(/duplicate-fieldset-/))return o="."+t,!0})),a.some((function(t){if(t.match(/duplicate-fieldset-maxRows-/))return l=t.substring("duplicate-fieldset-maxRows-".length),!0}));var d=document.querySelector(o+' [name*="_duplicate_"]:last-child');function u(){(i=document.querySelectorAll(o)).forEach((function(t,e){t.classList.remove("last","first"),0===e&&t.classList.add("first"),e===i.length-1&&t.classList.add("last"),function(t){var e;(e=t.querySelector(".duplication-buttons"))&&e.remove();(e=document.createElement("div")).classList.add("duplication-buttons");var i=document.createElement("button");i.type="button",i.classList.add("duplication-button","duplication-button--add"),i.textContent=n.buttonAdd,e.appendChild(i);var o=document.createElement("button");o.type="button",o.classList.add("duplication-button","duplication-button--remove"),o.textContent=n.buttonRemove,e.appendChild(o),n.prepend?t.insertBefore(e,t.firstChild):t.appendChild(e);r(t)}(t),t.classList.contains("duplicate")?t.querySelector(".duplication-buttons button.duplication-button--remove").style.display="block":t.querySelector(".duplication-buttons button.duplication-button--remove").style.display="none"}))}function r(t){t.querySelector(".duplication-buttons button.duplication-button--add").addEventListener("click",(function(e){return e.preventDefault(),function(t){if(null!==l&&i.length>=l)document.dispatchEvent(new Event("fieldset-clone-rejected"));else{var e=t.cloneNode(!0);c++;var o={};e.querySelectorAll("input[name], select[name], textarea[name]").forEach((function(e){e.classList.remove("error");var i=e.id;if(void 0!==i){(d=i.indexOf("_duplicate_"))>=0&&(i=i.substr(0,d));var l=i+"_duplicate_"+c;e.closest(n.widgetSelector).querySelectorAll('label[for="'+e.id+'"]').forEach((function(t){t.setAttribute("for",l),void 0!==t.id&&(t.id=t.id+"_duplicate_"+c)})),e.id=l}var a=e.name;if(void 0!==a){var d,u=a.endsWith("[]");u&&(a=a.substring(0,a.length-2)),(d=a.indexOf("_duplicate_"))>=0&&(a=a.substr(0,d));var r=a+"_duplicate_"+c;u&&(r+="[]"),e.name=r,o[a]=r}var s=e.getAttribute("value");"checkbox"!==e.type&&"radio"!==e.type?e.value&&t.classList.contains("duplicate-fieldset-donotcopy")&&(e.value=s):e.checked=!1})),e.querySelectorAll("fieldset[data-cff-condition]").forEach((function(t){let e=t.dataset.cffCondition;for(const[t,n]of Object.entries(o))e=e.replaceAll(t,n);t.dataset.cffCondition=e})),e.querySelectorAll("label").forEach((function(t){t.classList.remove("error")})),e.querySelectorAll("p.error").forEach((function(t){t.remove()})),e.querySelectorAll(n.widgetSelector).forEach((function(t){t.classList.remove("error")})),e.classList.add("duplicate"),r(e),t.after(e),u(),null!==l&&i.length>=l&&i.forEach((function(t){t.querySelector(".duplication-button--add").classList.add("disabled"),t.querySelector(".duplication-button--add").setAttribute("disabled","disabled")})),document.dispatchEvent(new Event("fieldset-cloned"))}}(t),!1})),t.classList.contains("duplicate")&&t.querySelector(".duplication-buttons button.duplication-button--remove").addEventListener("click",(function(e){return e.preventDefault(),function(t){i.length>1&&t.classList.contains("duplicate")&&(t.remove(),u())}(t),!1}))}d&&(c=parseInt(d.getAttribute("name").slice(-1),10)),u()}}();